body {
	display:flex;
	margin:0 0 4em;
	background:#bbb;
	user-select:none;
	justify-content:center;
	font:400 4.92svw/1.4 sans-serif;
	/*overscroll-behavior:contain;*/
}
body::after {
	top:2em;
	z-index:-1;
	position:absolute;
	content:'Chargement de l\'applicationâ€¦';
}
#combo_tempo,
select,
input:not([type]),
button {
	margin:0;
	color:#000;
	padding:0 .5em;
	background:#fff;
	appearance:none;
	user-select:none;
	border-radius:4px;
	background:no-repeat;
	box-sizing:border-box;
	font-family:sans-serif;
	border:1px solid hsl(240,10%,60%);
}
select {
	padding-right:.9em;
	background:white no-repeat right center;
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"><path d="m20 14l3 4 3 -4" fill="none" stroke-width="1" stroke="black" stroke-linejoin="round" stroke-linecap="round"/></svg>');
}
button:disabled {
	opacity:.6;
}
#sequencer {
	--margin-top:0em;
	--sheet-columns:2;
	--controls-lines:2;
	--drag-handle-width:0;
	--track-column-auto:1;
	--track-first-col-width:7.7em;
	background:#fff;
	position:relative;
	border:1px solid #999;
	border-radius:0 0 .5em .5em;
	margin-top:var(--margin-top);
	box-shadow:0 0 .5em rgba(0,0,0,.2);
	anchor-name:--sequencer;
}
#skip {
	display:block;
	font-size:.9em;
	width:fit-content;
	margin-bottom:-1.4em;
	clip-path:inset(100%);
}
#skip:focus {
	clip-path:none;
	padding:0 .2em;
	margin:.5em .5em 0;
}
h1 {
	font-size:1.2em;
	margin:.5em 0 0;
	padding:0 0 .3em;
	text-align:center;
	font-weight:normal;
}
h2 {
	margin:0;
	font-size:1.1em;
	text-align:center;
	font-weight:normal;
}
#skip:focus + h1 {
	margin-top:0;
}
table {
	border-spacing:0;
	margin:-.5em 0 1.8em;
}
tbody {
	display:flex;
	flex-direction:column;
}
.track {
	top:0;
	display:grid;
	position:relative;
	align-items:start;
	grid-template-rows:1em 1.65em 1fr;
	grid-template-columns:var(--track-first-col-width) repeat(var(--track-column-auto), auto);
}
.dropzone {
	z-index:1;
	padding:0;
	height:1em;
	grid-column:1 / -1;
}
.track th {
	gap:0 .5em;
	display:grid;
	padding:0 0 0 .7em;
	grid-template-columns:1fr;
	grid-template-rows:1.65em .3em 1.65em;
}
.sheet {
	gap:.3em;
	padding:0;
	display:grid;
	font-size:1em;
	grid-column:2;
	grid-row:span 2;
	margin:0 0 0 .9em;
	grid-template-columns:repeat(var(--sheet-columns),1fr);
}
.track td:last-of-type {
	grid-row:3;
	grid-column:1;
	height:1.5em;
	display:flex;
	align-items:center;
	padding:.3em 0 0 3.5em;
}
.track:focus-within ~ .track[data-instrument="0"] {
	transition:opacity .3s ease-out;
	transition-behavior:allow-discrete;
	opacity:1;
	@starting-style {
		opacity:0;
	}
}
.track[data-instrument="0"] ~ .track,
.track[data-bars^="[4,"] .bar:nth-child(n+5),
.track[data-bars^="[6,"] .bar:nth-child(n+7),
.track[data-bars^="[8,"] .bar:nth-child(n+9),
.track[data-bars^="[12,"] .bar:nth-child(n+13),
.track[data-bars^="[16,"] .bar:nth-child(n+17),
.track[data-bars^="[24,"] .bar:nth-child(n+25),
.track[data-beat="3"] .sub_bar .step:nth-last-child(-n+5),
.track[data-beat="4"] .sub_bar .step:nth-last-child(-n+4),
.track[data-beat="6"] .sub_bar .step:nth-last-child(-n+2) {
	display:none;
}
.track div[draggable] {
	display:grid;
	position:relative;
	grid-template-columns:var(--drag-handle-width) 1fr;
}
.track[data-loop="0"] div[draggable]::after {
	top:-.3em;
	content:'';
	width:.8em;
	height:.8em;
	right:-.3em;
	position:absolute;
	border-radius:100%;
	box-shadow:0 0 0 2px #fff;
	background:#000 url('data:image/svg+xml,<svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="m24 8v23h-5v-16l-6 2v-4z " fill="white"/></svg>');
}
.trackbutton {
	z-index:1;
	width:2em;
	grid-row:3;
	font-size:1em;
	overflow:hidden;
	color:transparent;
	background:center no-repeat url('data:image/svg+xml,<svg viewBox="0 0 46 46" xmlns="http://www.w3.org/2000/svg"><path d="M10 10v6a4 4 0 1 0 0.1 0m0 8v12M23 10v12a4 4 0 1 0 .1 0m0 8v6M36 10v8a4 4 0 1 0 .1 0m0 8v10" stroke-width="2" stroke="black" fill="none" stroke-linejoin="round" stroke-linecap="round"/></svg>');
}
.instrument {
	font-size:1em;
	grid-column:2;
	padding-left:.3em;
}
.track[data-beat="6"] .sheet,
.track[data-beat="8"] .sheet {
	grid-template-columns:repeat(calc(var(--sheet-columns) / 2),1fr);
}
.bar {
	gap:.3em;
	display:flex;
	position:relative;
	counter-increment:bar;
}
.track[data-bars$=",4]"] .bar:nth-child(4n+5),
.track[data-bars$=",6]"] .bar:nth-child(6n+7) {
	counter-reset:bar;
}
.sub_bar {
	gap:.3em;
	width:3.9em;
	display:flex;
	justify-content:space-evenly;
}
.track[data-beat="6"] .sub_bar,
.track[data-beat="8"] .sub_bar {
	width:9.5em;
}
.step {
	padding:0;
	z-index:1;
	border:none;
	width:1.1em;
	height:1.65em;
	font-size:1em;
	border-radius:.2em;
	background:hsl(240,10%,92%) no-repeat center;
}
.step[value="1"] {
	background-color:hsl(215,100%,43%);
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="6" fill="white"/></svg>');
}
.step[value="2"] {
	background-color:hsl(215,100%,43%);
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="6" fill="white" fill-opacity=".1" stroke="white" stroke-width="1.5"/><circle cx="10" cy="10" r="3.2" fill="white"/></svg>');
}
.step[value="3"] {
	background-color:hsl(215,100%,43%);
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 20 30" xmlns="http://www.w3.org/2000/svg"><line x1="14" y1="10" x2="6" y2="20" stroke="white" stroke-width="2.5" stroke-linecap="round"/></svg>');
}
.bar > .step[value="0"] {
	background-color:hsl(240,10%,83%);
	border:1px solid hsl(240,10%,50%);
}
.bar > .step[value="0"]::after {
	content:counter(bar);
}
.step.current {
	outline-offset:-.05em;
	outline:.2em solid hsl(130,30%,70%);
}
.bar > .step.current {
	outline-color:hsl(130,100%,25%);
}
.step.current:not([value="0"]) {
	height:1.5em;
	align-self:end;
	background-size:120%;
	background-position:center 70%;
	outline-color:hsl(130,100%,25%);
	background-color:hsl(130,100%,25%);
}
.step:has(~ .current):not([value="0"]),
.bar:has(.sub_bar .current) > .step:not([value="0"]),
.bar:has(~ .bar .current) .step:not([value="0"]) {
	background-color:hsl(215,68%,63%);
}
.bar::before {
	content:'';
	width:.21em;
	height:2.86em;
	position:absolute;
	border-radius:.2em;
	background:hsl(240,10%,60%);
	inset:-.6em auto auto .45em;
}
.volume {
	margin:0;
	padding:0;
	width:100%;
}
.dragged {
	top:.15em;
	transition:top .05s ease-out;
}
.track:has(+ .dragged) {
	top:-.15em;
	transition:top .05s ease-out;
}
.track.dragged .dropzone {
	height:1.3em;
	margin-top:-.3em;
}
.track.dragged .dropzone::after {
	content:'';
	height:.3em;
	display:block;
	background:#fff;
	border-radius:3px;
	margin:.5em 0 0 .7em;
	border:1px solid hsl(240,10%,20%);
}
hr {
	height:0;
	z-index:2;
	border:none;
	padding:.7em;
	position:sticky;
	background:#fff;
	margin:0 0 -2.5em;
	box-shadow:0 -.9px 0 hsl(240,10%,60%), 0 -4px 8px rgba(0,0,0,.1);
	bottom:calc(2.5rem * var(--controls-lines) - .2em + .7em * (var(--controls-lines) - 1));
}
#controls {
	gap:.7em;
	z-index:2;
	padding:.7em;
	display:flex;
	bottom:-.2em;
	flex-wrap:wrap;
	position:sticky;
	background:#fff;
	border-radius:0 0 .5em .5em;
}
#combo_presets {
	flex:1.4;
	display:flex;
}
#combo_presets button:focus,
#combo_presets select:focus {
	z-index:1;
}
#start {
	order:2;
}
#combo_tempo {
	flex:1;
	order:3;
	display:flex;
	height:2.5rem;
}
#reset {
	order:4;
}
#start,
#combo_presets button {
	padding:0;
	width:2.5rem;
	height:2.5rem;
	overflow:hidden;
	color:transparent;
}
#play,
#pause {
	width:100%;
	height:100%;
	pointer-events:none;
}
#play {
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg"><path d="m14 12l9 6-9 6z" stroke-width="1" stroke="black" stroke-linejoin="round"/></svg>');
}
#pause {
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg"><path d="m13.3 11v14h2v-14zm7 0v14h2v-14z" stroke-width="1" stroke="black" stroke-linejoin="round"/></svg>');
}
#pause,
.started #play {
	display:none;
}
.started #pause {
	display:block;
}
#combo_presets button {
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg"><path d="m22 10.5l3 7l8 1l-6 6l2 7l-7 -4l-7 4l2 -7l-6 -6l8 -1z" stroke-width="2" stroke="black" fill="none" stroke-linejoin="round" stroke-linecap="round"/></svg>');
}
#combo_presets:has([value]:checked) button {
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg"><path d="m22 10.5l3 7l8 1l-6 6l2 7l-7 -4l-7 4l2 -7l-6 -6l8 -1z" stroke-width="2" stroke="hsl(215,80%,43%)" fill="hsl(215,80%,43%)" stroke-linejoin="round" stroke-linecap="round"/></svg>');
}
#combo_presets select,
#reset {
	height:2.5rem;
	font-size:1em; 
}
#combo_presets select {
	flex:1;
	width:9em;
	margin-left:-1px;
	text-overflow:ellipsis;
	border-radius:0 4px 4px 0;
}
#combo_presets button {
	border-radius:4px 0 0 4px;
}
#tempo {
	flex:1;
	width:3em;
}
output[for="tempo"] {
	width:4em;
	margin-left:.5em;
	line-height:2.5rem;
}
dialog::backdrop {
	background:rgba(0,0,0,.4);
}
dialog {
	inset:1em;
	padding:0;
	outline:none;
	margin:0 auto;
	max-width:24em;
	border-radius:.5em;
	border:1px solid #555;
	box-sizing:border-box;
	width:calc(100% - 2em);
	box-shadow:0 0 .5em rgba(0,0,0,.3);
}
dialog::after {
	content:'';
	width:2.5em;
	height:2.5em;
	position:absolute;
	inset:0 0 auto auto;
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="m14 16l10 10m0 -10l-10 10" stroke-width="2" stroke="rgb(85,85,85)" stroke-linecap="round"/></svg>');
}
dialog:hover::after {
	filter:brightness(0);
}
dialog:has(:hover)::after {
	filter:none;
}
dialog>:first-child {
	gap:1em;
	padding:1em;
	display:flex;
	flex-direction:column;
}
dialog h2 {
	margin:0 1em;
}
#track {
	max-width:18em;
}
#track h2+div {
	gap:.5em;
	display:flex;
	flex-direction:column;
}
#track label {
	gap:.5em;
	z-index:1;
	display:grid;
	background:#fff;
	grid-template-columns:1.2fr 1fr;
}
#track select {
	height:1.8em;
	font-size:.9em;
}
#track select:has([selected][disabled]:checked)  {
	color:#757575;
}
#track option[value] {
	color:#000;
}
#track option[selected][disabled] {
	color:revert;
}
#preset {
	margin-bottom: -.5em;
}
#settings select,
#settings input {
	flex:1;
	width:100%;
	height:2em;
	font-size:.9em;
	text-overflow:ellipsis;
}
dialog button {
	height:2em;
	min-width:6em;
	font-size:.9em;
	background-color:hsl(240,10%,94%);
}
#settings input:disabled {
	border:none;
	cursor:text;
}
#settings fieldset {
	gap:1em;
	margin:0;
	display:flex;
	border:1px solid #555;
}
legend {
	font-size:.9em;
}
.bottom {
	gap:1em;
	width:100%;
	display:flex;
	max-width:22em;
	margin-top:.5em;
	align-self:center;
	justify-content:space-around;
}
#share form,
#shared > div {
	box-sizing:border-box;
	max-height:calc(100dvh - 2.5em);
}
dialog ul {
	margin:0;
	min-width:0;
	padding:.3em;
	min-height:4em;
	overflow-y:auto;
	border:1px solid #555;
}
ul {
	margin:0;
	padding:0;
}
#legend {
	z-index:1;
	background:#fff;
	padding:0 2px 0 0;
	align-self:flex-start;
	margin:-.1em 0 -1.75em .72em;
}
#share ul {
	position:relative;
	padding:0 .3em .3em .5em;
}
#share ul:before {
	top:0;
	content:'';
	height:.8em;
	display:block;
	position:sticky;
	background:#fff;
}
#share input[type="checkbox"] {
	margin-right:.5em;
}
label:has([name="current"]) {
	border:1px solid #555;
	padding:.3em .3em .3em .7em;
}
label:has([name="current"]:disabled) {
	display:none;
}
dialog li {
	font-size:.9em;
	overflow:hidden;
	text-wrap:nowrap;
	padding:0 0 .2em .2em;
	text-overflow:ellipsis;
}
button[name="share_list"] {
	padding-left:2em;
	background-image:url('data:image/svg+xml,<svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><circle cx="29" cy="12" r="4"/><circle cx="14" cy="20" r="4"/><circle cx="29" cy="28" r="4"/><path d="m27 13l-13 7l13 7" stroke-width="2" stroke="black" fill="none"/></svg>');
}
#toast {
	color:white;
	border:none;
	padding:0 1em;
	font-size:.8em;
	background:#333c;
	user-select:none;
	--anchor-size-height:100svh;
	inset:auto 0 max(0.8em, calc(100svh - var(--anchor-size-height) - 4.2em - var(--margin-top)));
	border-radius:.4em;
	backdrop-filter:blur(2px);
	box-shadow:0 0 .5em rgba(0,0,0,.2);
}
@supports (anchor-name:--sequencer) {
	#toast {
		position-anchor:--sequencer;
		--anchor-size-height:anchor-size(height);
	}
}
#toast:popover-open {
	animation:fade-out-button 1s forwards 5s;
}
#toast:has(button[hidden]):popover-open {
	animation:fade-out 1s forwards 2s;
}
#toast p {
	margin:1em 1em 1em 0;
	display:inline-block;
}
#toast button {
	padding:.2em .5em;
	font-size: inherit;
	background-color:hsl(240,10%,94%);
}
@keyframes fade-out {
	100% { opacity:0 }
}
@keyframes fade-out-button {
	100% { opacity:0 }
}
#aboutButton {
	right:.2em;
	color:#444;
	border:none;
	font-size:.8em;
	position:absolute;
	top:calc(100% + .3em);
}
#about div {
	gap:.5em;
	display:flex;
	flex-direction:column;
}
#about p {
	margin:0;
	line-height:1.2;
}
#about span {
	white-space:nowrap;
}
#contact {
	font-size:.9em;
}
#update {
	font-size:.8em;
	align-self:center;
}

@media (pointer:fine) and (hover:hover) {
	#combo_presets button:hover,
	#combo_presets select:hover {
		z-index:1;
	}
	input:not([type]):hover,
	#combo_tempo:hover,
	select:hover,
	button:not(.step):not(:disabled):hover {
		border-color:hsl(240,10%,20%);
	}
	button:not(.step):not(:disabled):hover {
		/*background-color:hsl(240,10%,85%);*/
	}
	.step:hover {
		filter:brightness(1.15);
	}
	.step[value="0"]:hover {
		filter:brightness(.9);
	}
	div[draggable]:hover .handle {
		opacity:.3;
		cursor:grab;
		background:no-repeat url('data:image/svg+xml,<svg viewBox="0 0 5 10" xmlns="http://www.w3.org/2000/svg"><path d="m3 1v8" stroke-width="1" stroke="black" stroke-linecap="round"/></svg>');
	}
	div[draggable]:active .handle {
		cursor:grabbing;
	}
	div[draggable] .handle:hover {
		opacity:1;
	}
	.track[data-instrument="0"] .handle {
		display:none;
	}
	#aboutButton:hover {
		color:#000;
	}
}
@media (min-width:520px) {
	body {
		font-size:clamp(.6em,2.4svw,1.2em);
	}
	#sequencer {
		--margin-top:.5em;
		--track-column-auto:2;
		--drag-handle-width:1em;
		--track-first-col-width:10.6em;
		--sheet-columns:4;
		--controls-lines:1;
		border-radius:.5em;
		padding-bottom:.3em;
	}
	h1 {
		font-size:1.4em;
	}
	h2 {
		font-size:1.2em;
	}
	.track th {
		padding:0;
		grid-template-rows:1.65em;
		grid-template-columns:1fr 2em;
	}
	.sheet {
		margin:0 1em;
	}
	.track td:last-of-type {
		width:4.9em;
		grid-row:auto;
		grid-column:auto;
		padding:0 1em 0 0;
	}
	.trackbutton {
		width:auto;
		grid-row:auto;
	}
	.track.dragged .dropzone::after {
		margin:.5em 1em;
	}
	#track label:nth-child(2) {
		grid-row:2;
		grid-column:1;
	}
	#track label:nth-child(3) {
		grid-row:1;
		grid-column:2;
	}
	#controls {
		gap:1em;
		padding:.7em 1em;
	}
	#start {
		order:4;
	}
	#reset {
		order:3;
	}
	legend {
		font-size:1em;
	}
}